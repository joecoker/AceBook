<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <meta charset="utf-8">
    <title>Acebook</title>
    <script>
    function updateTimes()
    {
      nodes = document.querySelectorAll('.timeago')
      timeago.render(nodes);
    }
    </script>
  </head>
  <body onload="updateTimes()">
    <h1><img src="/images/ace-of-spades.png" height="46" width="46" alt="">Acebook</h1>

    <h2><%= userDetails.firstname + ' ' + userDetails.lastname %>'s profile</h2>

    <div id="profile">

      <div id="profilepic">
        <img src="<%= userDetails.profilepictureurl %>" height="200" width="200">
      </div>

      <div id="profiledetails">
        <div id="profileemail">Email: <a href="mailto:<%= userDetails.email %>"><%= userDetails.email %></a></div>
        <div id="profiledob">Date of birth: <%= userDetails.dob %></div>
        <div id="profilejoined">Member since: <%= userDetails.createdat %></div>
      </div>

      <div id="editprofile">
        <% if (userDetails.userid === loggedInUser) { %>
        <a href="/user/edit/<%= userDetails.userid %>">Edit your profile</a>
        <% } %>
      </div>

    </div>

    <h2>Most recent posts</h2>

    <div id="posts">
      <% userPosts.forEach(function(post) { %>
        <div class="post">
          <div class="post-header">
            <%= post.firstname + ' ' + post.lastname %> <span class="timeago" datetime="<%= post.createdat %>"><a href="/post/<%= post.postid %>"></a></span>
          </div>
          <div class="post-content">
            <%= post.content %>
          </div>
          <div class="likes-count">
              <% if (post.likecount === 1) { %>
              There is 1 like
              <% } else { %>
              There are <%= post.likecount %> likes
              <% } %>
              <a href="/post/like/<%= post.postid %>">
                <% if (post.liked) { %>
                Unlike
                <% } else { %>
                Like
                <% } %>
              </a>
          </div>
          <div class="comments-count">
            <a href="/post/<%= post.postid %>">
              <% if (post.commentcount === 1) { %>
              There is 1 comment
              <% } else { %>
              There are <%= post.commentcount %> comments
              <% } %>
          </a>
          </div>
        </div>
      <% }) %>
    </div>

  </body>
  <script src="/js/timeago.min.js" type="text/javascript"></script>
</html>
